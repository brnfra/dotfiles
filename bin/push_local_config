#!/usr/bin/env bash
#  Arquivo: push_local_config
#  Autor: Bruno Franco
#  Ultima_modificacao: 08-03-2023
#  Download: git@github.com:brnfra
#  Licence:Este arquivo é de domínio público
#  Garantia: O autor não se responsabiliza por eventuais danos
#            causados pelo uso deste arquivo.
source "$HOME/bin/color-printf"
nowIn=$(pwd)
pushFrom="$HOME/Documents/Projects/git/dotfiles"
branch="main"
checkHome="$HOME/tests/dotfilesTest.sh"
cd "$HOME/tests" || return

# git push {{{  
function git_push () {
    message="${1:-"refactor: update dotfiles dir or scripts"}"
    git add -A -v;git commit -v -m "$message";git push origin $branch   
    if [ $? ];then
	git status -sb
	cmOk "Git add + and push"
    else
	git status -sb 
	clnError "A error occours. Check log."
    fi
}
# }}}

if "$checkHome" > /dev/null;
then
    cmOk "Files and folders check" 

    if [ -d "$pushFrom" ];then
	cd "$pushFrom" || return
	stage_local_config
	git_push "$1"
    else
	cError "No"
	clnItalic "$pushFrom" "found." 
	exit 1
    fi

    cd "$nowIn" || return
    exit 0
else
    "$checkHome" | awk '/FAIL/''{print}'
    cd "$nowIn" || return
    exit 1
fi

cd "$nowIn" || return
