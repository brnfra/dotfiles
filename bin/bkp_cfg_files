#!/usr/bin/env bash
# Arquivo: bkp_cfg_files
# Autor: Bruno Franco
# Download: git@github.com:brnfra
# Licence:Este arquivo é de domínio público
# Garantia: O autor não se responsabiliza por eventuais danos
#           causados pelo uso deste script.
# shellcheck source=dotfiles_env
. dotfiles_env

sname="${0##*/}"

if [[ "$1" == "-h" || "$1" == "--help" ]]; then cat <<HELP
$sname 

NAME
    $sname - Backup my config files

SYNOPSIS
    $sname [-h] --help

DESCRIPTION
    A simple script to backup my config files copy to defined in dotfiles_env (~/bin/dotfiles_env) backup folder.

    -h, --help
        Print help informations

See the README for documentation.
https://github.com/brnfra/dotfiles
Licensed under the MIT license.
HELP
exit; fi

bkp_cfg_files() {
    local DIR_DATE=$(date '+%d_%m_%Y')
    printf "\n[INFO]%s [START %s]\n" "${0##*/} - ${FUNCNAME[0]}" "$DIR_DATE"  >> "$bkpLog"
    cInfo "Backup config files:" "${0##*/} - ${FUNCNAME[0]}"

    # bash
    files='.bashrc .bash/ '
    files+='README.md '
    files+='.config/ '
    files+='.zsh/ '
    # vim
    files+='.vimrc .config/nvim/ '
    # vifm
    files+='.config/vifm/  '
    files+='.config/vifm/vifmrc  '
    files+='.config/vifm/scripts/ '
    files+='.config/vifm/colors/ '
    # terminalrc=
    files+='.config/xfce4/terminal/ '
    files+='.config/xfce4/terminal/terminalrc '
    files+='.config/conky/ '
    files+='.config/conky/conky1.10_shortcuts_maia '
    files+='.config/conky/conky_maia '
    files+='.config/conky/start_conky_maia '
    # i3
    files+='.i3/ '
    files+='.i3/autostart/ '
    files+='.i3/i3blocks/ '
    # rofi
    files+='.config/rofi/ .config/rofi/themes/ '
    # gsimplecal
    files+='.config/gsimplecal/ '
    files+='.config/gsimplecal/config '
    # systemrc
    files+='.wgetrc .curlrc  '
    # git
    files+='.gitconfig '
    files+='.git-completion.bash '
    # compton
    files+='.config/compton/ '
    files+='.config/compton/compton '
    # tmux
    files+='.tmux.conf '
    # scripts
    files+='bin/ '
    # test
    files+='test/ '
    for file in $files; do
        printf "[INFO] Files or folder to backup: (%s)\n" "$file" &>> "$bkpLog"
        newDir="${bkpdir}/${DIR_DATE}"

        if mkdir -p "${newDir}" ; then
            cp -r "${HOME}/$file" "${newDir}/$file" | sed '/^$/d;/./!d' &>> "$bkpLog"
        else
            cp -r "${HOME}/$file" "${newDir}/$file" | sed '/^$/d;/./!d' &>> "$bkpLog"
            cError "Cannot create dir: " "$newDir" 
        fi
    done
    echo >>"$bkpLog"

    printf "\n[INFO]%s [STOP %s]\n\n" "${0##*/} - ${FUNCNAME[0]}" "$DIR_DATE"  >> "$bkpLog"
    cInfo "Done!" "${0##*/} - ${FUNCNAME[0]}"
}
backup
"$@"
