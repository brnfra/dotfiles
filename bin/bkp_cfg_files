#!/usr/bin/env bash
# Arquivo: bkp_cfg_files
# Autor: Bruno Franco
# Ultima_modificacao: 07-11-2023
# Download: git@github.com:brnfra
# Licence:Este arquivo é de domínio público
# Garantia: O autor não se responsabiliza por eventuais danos
#           causados pelo uso deste script.
# shellcheck source=~/bin/dotfiles_env
. dotfiles_env

sname="${0##*/}"

if [[ "$1" == "-h" || "$1" == "--help" ]]; then cat <<HELP
$sname 

NAME
    $sname - Backup my config files

SYNOPSIS
    $sname [-h] --help

DESCRIPTION
    A simple script to backup my config files copy to defined in dotfiles_env (~/bin/dotfiles_env) backup folder.

    -h, --help
	Print help informations

See the README for documentation.
https://github.com/brnfra/dotfiles
Licensed under the MIT license.
HELP
exit; fi


bkp_cfg_files() {
    cInfo "Backup config files:" "bkp_cfg_files"
    printf "Check my config files \n"
    folders=".bash "
    folders+=".config/nvim "
    folders+=".config/vifm "
    folders+=".config/vifm/scripts "
    folders+=".config/vifm/colors "
    folders+=".config/xfce4/terminal "
    folders+=".i3 "
    folders+=".i3/autostart  "
    folders+=".i3/i3blocks "
    folders+=".config/rofi "
    folders+=".config/rofi/themes "
    folders+=".config/compton "
    folders+="bin "
    folders+="tests "
    clnInfo "Checking backup folders."
    for Folder in $folders
    do
	if [ -d "$bkpdir/$Folder" ]
	then
	    cInfo "Folder" "$bkpdir/$Folder" "Already exists."
	else
	    mkdir -p "$bkpdir/$Folder"
	    cInfo "Folder" "$bkpdir/$Folder" "Folders created."
	fi
    done
    cmOk "Folders"
    cInfo "Backup to files to" "$bkpdir"

    find "$HOME" -maxdepth 1 -name "*.backup" -type f | xargs -I {} mv {} "$bkpdir"
    for Folder in $folders; do
	cInfo "Moving to:" "$HOME/$Folder"
	if find "$HOME/$Folder" -maxdepth 1 -name "*.backup" -type f | xargs -I {} mv {} "$bkpdir/$Folder"
	then
	    wait $!
	else
	    continue
	fi

	wait 
    done
}

