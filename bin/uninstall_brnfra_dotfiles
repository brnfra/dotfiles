#!/usr/bin/env bash
#  Arquivo: uninstall_brnfra_dotfiles
#  Autor: Bruno Franco
#  Download: git@github.com:brnfra
#  Licence:Este arquivo é de domínio público
#  Garantia: O autor não se responsabiliza por eventuais danos
#            causados pelo uso deste arquivo.
. dotfiles_env
bkpdir="$HOME"/.config-bkp/original

# restaure *.backup
function restore() {
    printf "[INFO] Restore original files\n" 
    cp -ar "$bkpdir"/. $HOME
}

# clean
function uninstall() {
    printf "[INFO] uninstall \n" 
    printf "[INFO] unstow \n" 
    if [ -e "$dotfiles_dir" ];then
	cd $dotfiles_dir
	stow -D --dotfiles --target=$HOME .
    fi
    cd $HOME

    list="$HOME/.wallpapers "
    list+=" $HOME/.config-bkp "
    list+=" $HOME/.dotfiles "
    list+=" $HOME/example "
    list+=" $HOME/bin "
    list+=" $HOME/tests "
    list+=" $HOME/test "
    list+=" $HOME/.github "
    list+=" $HOME/LICENSE "
    list+=" $HOME/README.md "
    list+=" $HOME/Dockerfile "
    list+=" $HOME/docker-compose.yml "
    list+=" $dotfiles_dir "
    printf "[INFO] removing dotfiles\n"
    for item in $list
    do
	if [ -e "$item" ];then
	    rm -rf "$item"
	else
	    printf "%s not found.\n" "$item"
	fi
    done
}

uninstall 
restore
printf "[INFO] uninstall complete. %s \n" "$(date)" 
cd "$HOME" || return
