#!/usr/bin/env bash

# code providing by ;
#  - originally by user StreakyCobra in https://news.ycombinator.com/item?id=11070797
#  - in your wonderful tutorial, Nicola Paolucci, in https://www.atlassian.com/git/tutorials/dotfiles
BKPDIR="$HOME"/.config-backup/
if [ -d "$BKPDIR" ] 
then
	mkdir -p "$BKPDIR"
fi

REPO="https://github.com/brnfra/dotfiles.git"

git clone --branch mingw32-w8-cfg --bare $REPO "$HOME/.dotfiles";

function config {
    git --git-dir="$HOME"/.dotfiles/ --work-tree=$HOME $@;
}

config checkout

if [ $? = 0 ]; then
    echo "Checked out config.";
  else
    echo "Backing up pre-existing dot files.";
    config checkout 2>&1 | egrep "^\s+" | awk {'print $1'} | xargs -I{} mv "$HOME"/{} "$BKPDIR"
fi

config checkout
config config status.showUntrackedFiles no
